!function(i,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(i=i||self).Clipic=t()}(this,function(){"use strict";var i=function(){function e(i,t){for(var n=0;n<t.length;n++){var e=t[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}return function(i,t,n){return t&&e(i.prototype,t),n&&e(i,n),i}}();return function(){function t(i){!function(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=i,this.scaleX=1,this.scaleY=1,this.rotate=0,this.init(),this.clipicFrame=this.getId("clipicFrame"),this.clipic=this.getId("clipic"),this.clipicCancel=this.getId("clipicCancel"),this.clipicImg=document.createElement("img"),this.clipicFrame.appendChild(this.clipicImg)}return i(t,[{key:"init",value:function(){this.createStyle(),this.createHtml()}},{key:"getId",value:function(i){return document.getElementById(i)}},{key:"createStyle",value:function(){var i=document.createElement("style");i.type="text/css";var t='\n      .clipic-body {\n        background: #1c1c1c;\n        position: fixed;\n        width: 100%;\n        height: 100%;\n        top: 0;\n        left: 0;\n        transform: translate(0, 100%);\n        transition: 0.4s;\n        -webkit-touch-callout: none;\n        -webkit-user-select: none;\n        box-sizing: border-box;\n      }\n      .clipic-body * {\n        box-sizing: border-box;\n      }\n      .clipic-operation-bar {\n        display: flex;\n        color: #f2f2f2;\n        justify-content: space-between;\n        position: absolute;\n        width: 100%;\n        bottom: 0;\n        left: 0;\n      }\n      .clipic-operation-bar [role="button"] {\n        padding: 15px 20px;\n        font-size: 1em;\n      }\n      .clipic-frame {\n        height: 300px;\n        margin: 30px;\n        background: #f2f2f2;\n        overflow: hidden;\n      }\n      .clipic-frame img {\n        transition: transform 0.5s linear;\n      }\n      .clipic-cancel {\n        color: #3680fd;\n      }\n      .clipic-confirm{\n        color: #23c667;\n      }\n    '.trim();i.innerHTML=t,document.getElementsByTagName("HEAD").item(0).appendChild(i)}},{key:"createHtml",value:function(){var i=document.createElement("div");i.className="clipic-body",i.setAttribute("id","clipic");var t='\n      <div class="clipic-frame" id="clipicFrame"></div>\n      <div class="clipic-operation-bar">\n        <div class="clipic-cancel" id="clipicCancel" role="button">取消</div>\n        <div class="clipic-confirm" id="clipicConfirm" role="button">完成</div>\n      </div>\n    '.trim();i.innerHTML=t,document.body.appendChild(i)}},{key:"getImage",value:function(){var i=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this.newOptions=Object.assign(this.options||{},t),this.newOptions.ratio=this.newOptions.ratio||this.newOptions.width/this.newOptions.height,this.clipicFrame.style.height=this.clipicFrame.clientWidth/this.newOptions.ratio+"px",this.clipicImg.src=this.newOptions.src,this.clipicImg.onload=function(){i.originW=i.clipicImg.width,i.originH=i.clipicImg.height,i.originRatio=i.originW/i.originH,i.initSize(),i.clipic.style.transform="translate(0, 0)",i.clipicCancel.addEventListener("click",function(){i.cancel()})}}},{key:"initSize",value:function(){this.newOptions.ratio>this.originRatio?(this.clipicImg.style.width=this.clipicFrame.clientWidth+"px",this.clipicImg.style.transform="translate(0, -"+(this.clipicImg.clientHeight-this.clipicFrame.clientHeight)/2+"px)"):(this.clipicImg.style.height=this.clipicFrame.clientHeight+"px",this.clipicImg.style.transform="translate(-"+(this.clipicImg.clientWidth-this.clipicFrame.clientWidth)/2+"px, 0)")}},{key:"cancel",value:function(){this.clipic.style.transform="translate(0, 100%)",this.clipicImg.style="",this.clipicImg.src=""}}]),t}()});
